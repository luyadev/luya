!function($){$.textToSpeech=function(options){var settings=$.extend({playButtonSelector:"#play-button",pauseButtonSelector:"#pause-button",stopButtonSelector:"#stop-button",playClass:"played",pauseClass:"paused",targetSelector:".main-content",text:"",playEvent:"textToSpeech:play",pauseEvent:"textToSpeech:pause",stopEvent:"textToSpeech:stop",eventSelector:"body",language:"en",favoriteVoice:""},options);if("speechSynthesis"in window)with(speechSynthesis){var onClickPlay=function(){if(!flag){flag=!0;var e=$(settings.targetSelector).text();settings.text instanceof Function?e=settings.text():0<settings.text.length&&(e=settings.text),utterance=new SpeechSynthesisUtterance(e),window.speechSynthesis.cancel(),new Promise(function(e,t){var s=window.speechSynthesis.getVoices();0!==s.length?e(s):window.speechSynthesis.addEventListener("voiceschanged",function(){s=window.speechSynthesis.getVoices(),e(s)})}).then(function(e){utterance.voice=e.filter(function(e){return e.lang===settings.language})[0],utterance.voice=e.filter(function(e){return e.name===settings.favoriteVoice})[0]}),$(window).on("beforeunload",function(){window.speechSynthesis.cancel()}),utterance.volume=1,utterance.rate=1,utterance.pitch=1,utterance.lang=settings.language,utterance.onend=function(){flag=!1,$playElement.removeClass(settings.playClass)},$playElement.toggleClass(settings.playClass),window.speechSynthesis.speak(utterance)}paused&&($playElement.toggleClass(settings.playClass),$pauseElement.toggleClass(settings.pauseClass),window.speechSynthesis.resume(),paused=!1),$(settings.eventSelector).trigger(settings.playEvent)},onClickPause=function(){!paused&&window.speechSynthesis.speaking&&($pauseElement.addClass(settings.pauseClass),$playElement.removeClass(settings.playClass),paused=!0,window.speechSynthesis.pause(),$(settings.eventSelector).trigger(settings.pauseEvent))},onClickStop=function(){window.speechSynthesis.speaking&&(paused&&(paused=!1,$pauseElement.removeClass(settings.pauseClass),$playElement.removeClass(settings.playClass)),flag=!1,window.speechSynthesis.cancel(),$(settings.eventSelector).trigger(settings.stopEvent))},$playElement=$(settings.playButtonSelector),$pauseElement=$(settings.pauseButtonSelector),$stopElement=$(settings.stopButtonSelector),flag=!1,paused=!1;$playElement.on("click",onClickPlay),$pauseElement.on("click",onClickPause),$stopElement.on("click",onClickStop)}}}(jQuery);